<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>{{title}}</title>
  <style>
    /* ===== Theme ===== */
    :root {
      --accent: #0B6DFF; /* update to your brand */
      --text: #111827;   /* gray-900 */
      --muted: #6B7280;  /* gray-500 */
      --border: #E5E7EB; /* gray-200 */
      --chip: #F3F4F6;   /* gray-100 */
      --table-head: #F9FAFB; /* gray-50 */
    }

    /* ===== Page & Typography ===== */
    @page {
      size: A4; /* switch to Letter if you prefer */
      margin: 28mm 20mm 22mm;
      @bottom-right {
        content: "Page " counter(page) " of " counter(pages);
        color: var(--muted);
        font-size: 9pt;
      }
      @bottom-left {
        content: "Generated by Documentation GPT";
        color: var(--muted);
        font-size: 9pt;
      }
    }

    html, body { height: 100%; }
    body {
      -webkit-font-smoothing: antialiased; -moz-osx-font-smoothing: grayscale;
      font-family: Inter, ui-sans-serif, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
      color: var(--text);
      font-size: 11pt;
      line-height: 1.45;
    }

    /* ===== Layout ===== */
    .header {
      display: flex;
      justify-content: space-between;
      align-items: flex-end;
      border-bottom: 2.5pt solid var(--accent);
      padding-bottom: 8pt;
      margin-bottom: 12pt;
    }
    .title { font-size: 18pt; font-weight: 700; letter-spacing: .2px; }
    .meta {
      display: grid;
      grid-template-columns: auto 1fr;
      gap: 4pt 12pt;
      font-size: 10pt;
      color: var(--muted);
    }
    .badges { margin-top: 4pt; }
    .badge {
      display: inline-block;
      padding: 2pt 8pt;
      border: 1px solid var(--border);
      background: var(--chip);
      border-radius: 999px;
      margin-right: 6pt;
      text-transform: capitalize; /* helps normalize platforms/tools visually */
      font-size: 10pt;
    }

    h2 {
      font-size: 12.5pt;
      margin: 14pt 0 6pt;
      border-bottom: 1px solid var(--border);
      padding-bottom: 4pt;
    }

    p { margin: 6pt 0; }

    .grid-2 {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 12pt;
    }

    table { width: 100%; border-collapse: collapse; font-size: 10.5pt; }
    th, td { border: 1px solid var(--border); padding: 6pt 8pt; vertical-align: top; }
    th { background: var(--table-head); text-align: left; font-weight: 600; }
    td a { color: var(--accent); text-decoration: none; }
    td.url { word-break: break-word; overflow-wrap: anywhere; }

    ul { margin: 6pt 0 0 18pt; }

    .callout { border-left: 3pt solid var(--accent); background: #F8FAFF; padding: 8pt 10pt; }
    .muted { color: var(--muted); }

    footer.fallback {
      border-top: 1px solid var(--border);
      padding-top: 6pt; font-size: 9pt; color: var(--muted);
      display: flex; justify-content: space-between; margin-top: 12pt;
    }
  </style>
</head>
<body>
  <!-- Header -->
  <div class="header">
    <div>
      <div class="title">{{title}}</div>
      <div class="badges">
        <span class="badge">{{frequency}}</span>
        {{#automated}}<span class="badge">automated</span>{{/automated}}
        {{^automated}}<span class="badge">manual</span>{{/automated}}
      </div>
    </div>
    <div class="meta">
      <div>Media Team</div><div>{{media_team}}</div>
      <div>Owner</div><div>{{owner.name}} — {{owner.email}}</div>
      {{#version}}<div>Version</div><div>{{version}}</div>{{/version}}
    </div>
  </div>

  <!-- Description -->
  <section>
    <h2>Description</h2>
    <p>{{description}}</p>
  </section>

  <!-- Platforms / Tools + Links -->
  <section class="grid-2">
    <div>
      <h2>Platforms</h2>
      <p>
        {{#platforms}}<span class="badge">{{.}}</span> {{/platforms}}
        {{^platforms}}—{{/platforms}}
      </p>

      <h2>Tools</h2>
      <p>
        {{#tools}}<span class="badge">{{.}}</span> {{/tools}}
        {{^tools}}—{{/tools}}
      </p>
    </div>

    <div>
      <h2>Links</h2>
      <table>
        <thead>
          <tr><th>Type</th><th>Title</th><th>URL</th></tr>
        </thead>
        <tbody>
          {{#google_sheets}}
            <tr><td>Google Sheet</td><td>{{subtitle}}</td><td class="url"><a href="{{url}}">{{url}}</a></td></tr>
          {{/google_sheets}}
          <tr><td>Report</td><td>—</td><td class="url"><a href="{{report_link}}">{{report_link}}</a></td></tr>
          {{#automated}}
            {{#bigquery_link}}
              <tr><td>BigQuery</td><td>Source</td><td class="url"><a href="{{bigquery_link}}">{{bigquery_link}}</a></td></tr>
            {{/bigquery_link}}
          {{/automated}}
        </tbody>
      </table>
    </div>
  </section>

  <!-- Adjustments -->
  <section>
    <h2>Adjustments Needed</h2>
    {{#adjustments}}
    <ul>
      {{#adjustments}}<li>{{.}}</li>{{/adjustments}}
    </ul>
    {{/adjustments}}
    {{^adjustments}}<p class="muted">None.</p>{{/adjustments}}
  </section>

  <!-- Notes / FAQ -->
  <section>
    <h2>Notes / FAQ</h2>
    <div class="callout">
      <p>{{notes}}</p>
    </div>
  </section>

  <!-- Changelog -->
  {{#changelog}}
  {{#length}}
  <section>
    <h2>Changelog</h2>
    <table>
      <thead><tr><th>Date</th><th>Change</th></tr></thead>
      <tbody>
        {{#items}}<tr><td>{{date}}</td><td>{{change}}</td></tr>{{/items}}
      </tbody>
    </table>
  </section>

  <!-- Footer fallback (for renderers without @page margin boxes) -->
  <div class="fallback footer">
    <span>Generated by Documentation GPT • Version {{version}}</span>
    <span>Generated: {{generated_at}} — Page {{page}} of {{pages}}</span>
  </div>

  <!-- Optional JS page-numbering fallback (ignored by wkhtmltopdf); safe no-op if not supported) -->
  <script>
    (function() {
      try {
        var pages = document.querySelectorAll('.fallback .pages');
        /* You can wire your renderer to inject {{page}} / {{pages}} or ignore this script */
      } catch (e) {}
    })();
  </script>
</body>
</html>
